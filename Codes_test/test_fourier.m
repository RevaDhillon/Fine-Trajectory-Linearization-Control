
clc; close all; clear;
% 
% w = [-1.68051336735253e-18	-0.00372177795850124	-0.00501418025523633	-0.00541249561597815	-0.00548707020881452	-0.00544966014466080	-0.00537841818392814	-0.00530163512388292	-0.00522928533187036	-0.00516466101483927	-0.00510857250347391	-0.00506086646648494	-0.00502107346130183	-0.00498863910290529	-0.00496297690887034	-0.00494350969396333	-0.00492968036550218	-0.00492095589020395	-0.00491682862983607	-0.00491681660673087	-0.00492046328144674	-0.00492733706125194	-0.00493703062308877	-0.00494916011768095	-0.00496338317855099	-0.00497937204129892	-0.00499680636666122	-0.00501539178139904	-0.00503485894260456	-0.00505496256296673	-0.00507548039608951	-0.00509621218112054	-0.00511697854618137	-0.00513761987036977	-0.00515799510443868	-0.00517798055062998	-0.00519746860255621	-0.00521636644647069	-0.00523459472574293	-0.00525208617085349	-0.00526878419773521	-0.00528464147780636	-0.00529961848356112	-0.00531368201409203	-0.00532680370541305	-0.00533895853091992	-0.00535012812932858	-0.00536036040264805	-0.00536967670245831	-0.00537808800332340	-0.00538561279217918	-0.00539227618497534	-0.00539810904444513	-0.00540314709798376	-0.00540743005488904	-0.00541100072249699	-0.00541390412103366	-0.00541618659729466	-0.00541789493755602	-0.00541907548041127	-0.00541977323051684	-0.00542003097450928	-0.00541988840063105	-0.00541938122386439	-0.00541854031862269	-0.00541739086128534	-0.00541595148508139	-0.00541423345003062	-0.00541223983083458	-0.00540996714840752	-0.00540743213058460	-0.00540465711732518	-0.00540165617178798	-0.00539843585454944	-0.00539499529175988	-0.00539132628623634	-0.00538741346959110	-0.00538323449331978	-0.00537876025663519	-0.00537395516873252	-0.00536877744310974	-0.00536317942154395	-0.00535710792533806	-0.00535050463150403	-0.00534330647163315	-0.00533544605132226	-0.00532685208817109	-0.00531744986653887	-0.00530716170744261	-0.00529590745219260	-0.00528360495858659	-0.00527017060871899	-0.00525551982770133	-0.00523956761282809	-0.00522222383757228	-0.00520337651958850	-0.00518294125418900	-0.00516083479802031	-0.00513697048116378	-0.00511125892148838	-0.00508360874099139	-0.00505392728000799	-0.00502212130527326	-0.00498809770792807	-0.00495176418767272	-0.00491302991938362	-0.00487180619861715	-0.00482800706252687	-0.00478154988281385	-0.00473235592741252	-0.00468035088768392	-0.00462546536794534	-0.00456763533420601	-0.00450680251900642	-0.00444291477927164	-0.00437592640408885	-0.00430578721677342	-0.00423242650582148	-0.00415580199393132	-0.00407587630710099	-0.00399261505143416	-0.00390598679904702	-0.00381596308549459	-0.00372251841757366	-0.00362563029011133	-0.00352527921011920	-0.00342144872648343	-0.00331412546317564	-0.00320329915380679	-0.00308896267521031	-0.00297111207763222	-0.00284974660902522	-0.00272486873089368	-0.00259648412311629	-0.00246460167518367	-0.00232923346133246	-0.00219039469713027	-0.00204810367517424	-0.00190238167770294	-0.00175325286409157	-0.00160074413139967	-0.00144484446220219	-0.00128547246995623	-0.00112269800313731	-0.000956600227223959	-0.000787255733691156	-0.000614738858632884	-0.000439122014944906	-0.000260476037536309	-7.88705413289140e-05	0.000105625707932889	0.000292944409806064	0.000483017331752151	0.000675775897604171	0.000871150761159826	0.00106907136408443	0.00126946547727106	0.00147225872481413	0.00167737408980563	0.00188473140126187	0.00209424680162883	0.00230583219449787	0.00251939467238576	0.00273483592469103	0.00295205162623045	0.00317093080707827	0.00339135520477405	0.00361319860032498	0.00383632613980218	0.00406059364370831	0.00428584690667225	0.00451192099039696	0.00473863951314290	0.00496581393936513	0.00519324287342956	0.00542071136160815	0.00564799020678657	0.00587483530050667	0.00610098697710451	0.00632616939478867	0.00655015637416038	0.00677278758327633	0.00699384458217307	0.00721309593270814	0.00743029897784100	0.00764520143368636	0.00785754296696951	0.00806705674610522	0.00827347095462974	0.00847651025632430	0.00867589720207609	0.00887135356932653	0.00906260162584669	0.00924936531055982	0.00943137132518037	0.00960835013156074	0.00978003685081498	0.00994617206151416	0.0101065024955112	0.0102607816312398	0.0104087701856344	0.0105502365071167	0.0106849568733902	0.0108127156990468	0.0109333056592288	0.0110465277367728	0.0111521912013996	0.0112501135305771	0.0113401202826795	0.0114220178519373	0.0114956392785792	0.0115609554805020	0.0116179493146840	0.0116666105200267	0.0117069361902245	0.0117389312753133	0.0117626091071929	0.0117779919442425	0.0117851115300166	0.0117840096609056	0.0117747387575760	0.0117573624349606	0.0117319560655487	0.0116986073307218	0.0116574167548949	0.0116084982172411	0.0115519794358053	0.0114880024188428	0.0114167238782398	0.0113383155998999	0.0112529647659891	0.0111608742239379	0.0110622626970902	0.0109573649318715	0.0108464317763154	0.0107297301847500	0.0106075431433943	0.0104801695115619	0.0103478915189630	0.0102108105173616	0.0100691289607401	0.00992307400173435	0.00977287046717615	0.00961874011230304	0.00946090094794021	0.00929956663621585	0.00913494595013819	0.00896724229219920	0.00879665326707899	0.00862337030350308	0.00844757832034876	0.00826945543220916	0.00808917268979450	0.00790689385078192	0.00772277517701159	0.00753696525426336	0.00734960483123277	0.00716082667474917	0.00697075543874090	0.00677950754494508	0.00658719107387805	0.00639390566511862	0.00619974242650855	0.00600479087344330	0.00580914871437835	0.00561290078409544	0.00541612709780095	0.00521890343487153	0.00502130154991476	0.00482338940053746	0.00462523139105117	0.00442688863153060	0.00422841921180575	0.00402987849010726	0.00383131939620542	0.00363279274896638	0.00343434758831221	0.00323603152159744	0.00303789108441461	0.00283997211580552	0.00264232014779142	0.00244498080903876	0.00224800024235516	0.00205142553555395	0.00185530516505422	0.00165968945137983	0.00146463102550466	0.00127018530475746	0.00107641097675435	0.000883370489575724	0.000691130546150389	0.000499762600558451	0.000309343353722538	0.000119962113704693	-6.82723154691763e-05	-0.000255301315358339	-0.000441064822752146	-0.000625494338997942	-0.000808513492907779	-0.000990038632629406
% 8.63295979841583e-18	-0.0112226061741465	-0.0151583034258265	-0.0163618154375051	-0.0165428623634537	-0.0163420593719959	-0.0159982244837451	-0.0155993177454925	-0.0151776899700983	-0.0147453659656230	-0.0143068076989028	-0.0138635317330057	-0.0134160612523051	-0.0129646213570301	-0.0125092947379081	-0.0120501380893764	-0.0115872108699408	-0.0111205845347476	-0.0106503447132742	-0.0101765909096225	-0.00969943540144924	-0.00921900194875760	-0.00873542453371011	-0.00824884617341517	-0.00775940106388760	-0.00726725690515856	-0.00677261338127714	-0.00627567659712172	-0.00577665833947312	-0.00527577544989911	-0.00477324931230049	-0.00426930545816480	-0.00376417329265162	-0.00325808594458377	-0.00275128024321943	-0.00224399682433951	-0.00173648036769733	-0.00122897996725111	-0.000721749634839143	-0.000215048937072212	0.000290856235781912	0.000795692771247017	0.00129917930993173	0.00180102509943524	0.00230092873293968	0.00279857677990267	0.00329364547825109	0.00378585646943860	0.00427493644797784	0.00476059714968775	0.00524254442309095	0.00572047931415197	0.00619409906936114	0.00666309804409951	0.00712716850454034	0.00758600131276622	0.00803928648629549	0.00848671362480444	0.00892797219849123	0.00936275169423625	0.00979074161745920	0.0102116313493378	0.0106251098608213	0.0110308652866290	0.0114285843641484	0.0118179517438359	0.0121986491793410	0.0125703546071327	0.0129327411268672	0.0132854599731992	0.0136281274099916	0.0139605237134931	0.0142824408031809	0.0145936599123680	0.0148939541981889	0.0151830912907118	0.0154608357702865	0.0157269515631055	0.0159812042459275	0.0162233632519730	0.0164532039711434	0.0166705097389191	0.0168750737095471	0.0170667006104165	0.0172452083758276	0.0174104296596656	0.0175622132277823	0.0177004252321460	0.0178249503700313	0.0179356929326653	0.0180325777488109	0.0181155510297438	0.0181845811229434	0.0182396591825701	0.0182807769278335	0.0183078394560244	0.0183208753987809	0.0183199395474200	0.0183050917199552	0.0182763973372114	0.0182339280321296	0.0181777622855809	0.0181079860816383	0.0180246935748906	0.0179279877620447	0.0178179811497278	0.0176947964100886	0.0175585670154849	0.0174094378432544	0.0172475657412747	0.0170731200447498	0.0168862830343983	0.0166872503259753	0.0164762311808386	0.0162534487270678	0.0160191400804795	0.0157735256822405	0.0155167605324158	0.0152490685123289	0.0149706811787600	0.0146818318695375	0.0143827550310686	0.0140736856698832	0.0137548589168007	0.0134265096919288	0.0130888724584299	0.0127421810528406	0.0123866685796937	0.0120225673582806	0.0116501089095800	0.0112695239716887	0.0108810425324866	0.0104848938687747	0.0100813065817156	0.00967050861908174	0.00925272727557545	0.00882818916331230	0.00839712014545191	0.00795974522691164	0.00751628839709888	0.00706697242063800	0.00661194680312457	0.00615123244673967	0.00568511544822249	0.00521389370905610	0.00473785598350665	0.00425728261465590	0.00377244625473776	0.00328361257143533	0.00279104094277540	0.00229498514413658	0.00179569403165434	0.00129341222695538	0.000788380808676917	0.000280838016618872	-0.000228980025364513	-0.000740838561507723	-0.00125450342510360	-0.00176974022224891	-0.00228631347260759	-0.00280398570186057	-0.00332251648106358	-0.00384166140880874	-0.00436117103287182	-0.00488078970891323	-0.00540025439477898	-0.00591929337999991	-0.00643762495120316	-0.00695495599531062	-0.00747098054358923	-0.00798537826082093	-0.00849781288505536	-0.00900793062458111	-0.00951535851988109	-0.0100197027794062	-0.0105205470989949	-0.0110174509756634	-0.0115099480272813	-0.0119975443303140	-0.0124797167883474	-0.0129560457464003	-0.0134262517516522	-0.0138899454678671	-0.0143467171108392	-0.0147961400213489	-0.0152377738144845	-0.0156711674539835	-0.0160958622309494	-0.0165113946276269	-0.0169172990484058	-0.0173131104018700	-0.0176983665195036	-0.0180726103985993	-0.0184353922589652	-0.0187862714051887	-0.0191248178884652	-0.0194506139643180	-0.0197632553449037	-0.0200623522469948	-0.0203475302391360	-0.0206184308938549	-0.0208747122531648	-0.0211160491178861	-0.0213421331735304	-0.0215526729676051	-0.0217473937551995	-0.0219260372315749	-0.0220883611722011	-0.0222341390022349	-0.0223631036336002	-0.0224750316071511	-0.0225699712225640	-0.0226479925221969	-0.0227091767876906	-0.0227536171987056	-0.0227814195871708	-0.0227927032756639	-0.0227876019879663	-0.0227662648193588	-0.0227288572538610	-0.0226755622153458	-0.0226065811392865	-0.0225221350517977	-0.0224224656426124	-0.0223078363186827	-0.0221785332251903	-0.0220348662209008	-0.0218771697949740	-0.0217058039125554	-0.0215211547767016	-0.0213236354944362	-0.0211136866349787	-0.0208917766684450	-0.0206584022735628	-0.0204140885031984	-0.0201593887967291	-0.0198948848285423	-0.0196211861821828	-0.0193388672642321	-0.0190481495832098	-0.0187494498961030	-0.0184432311978657	-0.0181299503540289	-0.0178100567902948	-0.0174839913155746	-0.0171521850701309	-0.0168150585901741	-0.0164730209800746	-0.0161264691832905	-0.0157757873431618	-0.0154213462448953	-0.0150635028303381	-0.0147025997775196	-0.0143389651374188	-0.0139729120209761	-0.0136047383300178	-0.0132347265264734	-0.0128631434350516	-0.0124902400753699	-0.0121162515204121	-0.0117413967790978	-0.0113658787016799	-0.0109898839076328	-0.0106136000505051	-0.0102372312110240	-0.00986094593031249	-0.00948490378312649	-0.00910925679323713	-0.00873414979707082	-0.00835972083195043	-0.00798610154758453	-0.00761341763974461	-0.00724178930532823	-0.00687133171822693	-0.00650215552559824	-0.00613436736427570	-0.00576807039714099	-0.00540336486932558	-0.00504034868410246	-0.00467911799827529	-0.00431976783677169	-0.00396239272600023	-0.00360708734534231	-0.00325394719591765	-0.00290306928550022	-0.00255455282816052	-0.00220849995688961	-0.00186501644711537	-0.00152421244866586	-0.00118620322337151	-0.000851109885134989	-0.000519060138946269	-0.000190189014982460	0.000135347662835874	0.000457356566163664	0.000775734144214099	0.00109037654598158	0.00140116716020523	0.00170797775850705	0.00201066967894582
% 1.01643953670516e-19	0.0196205518261912	0.0264749386826913	0.0285552489436621	0.0288573312270704	0.0285026086382849	0.0279090572116618	0.0272308416480869	0.0265249413463359	0.0258127946150176	0.0251025815069426	0.0243972860546351	0.0236981022319140	0.0230056433070936	0.0223202187856495	0.0216420415616899	0.0209712820940944	0.0203080882178018	0.0196525923447327	0.0190049140518614	0.0183651609956023	0.0177334292335175	0.0171098033527250	0.0164943566092899	0.0158871833514548	0.0152883607213463	0.0146979372546589	0.0141159636920402	0.0135424923469764	0.0129775764741840	0.0124212696470811	0.0118736251531464	0.0113346954161316	0.0108045314541363	0.0102831823824711	0.00977069497001922	0.00926711325746294	0.00877247824525936	0.00828682765865241	0.00781019579628227	0.00734261346811923	0.00688410802751120	0.00643470350110247	0.00599442081927081	0.00556327814855152	0.00514129132628738	0.00472847708687665	0.00432488086403001	0.00393051689084762	0.00354538835020713	0.00316949846895236	0.00280284958217524	0.00244544226370888	0.00209727453145092	0.00175834113520777	0.00142863293377401	0.00110813636694153	0.000796833027081184	0.000494699333862560	0.000201706314585449	-8.21805085016946e-05	-0.000357001123615117	-0.000622800928380331	-0.000879630524164497	-0.00112754540867778	-0.00136660557070764	-0.00159687499178272	-0.00181842106043771	-0.00203131390556021	-0.00223562072108202	-0.00243139909333641	-0.00261875802552245	-0.00279781447671630	-0.00296868629711375	-0.00313149256669458	-0.00328635389887527	-0.00343339270836279	-0.00357273344272142	-0.00370450277747912	-0.00382882977492676	-0.00394584600710022	-0.00405568564377708	-0.00415848550666521	-0.00425438509130343	-0.00434352655853311	-0.00442605469772884	-0.00450211686429217	-0.00457186289421308	-0.00463544499878117	-0.00469301764278567	-0.00474473740977018	-0.00479076285810593	-0.00483125437181373	-0.00486637401019304	-0.00489627846400679	-0.00492109419802825	-0.00494098157755803	-0.00495610264288020	-0.00496661426203778	-0.00497266808137790	-0.00497441053947902	-0.00497198294050938	-0.00496552158277822	-0.00495515793799609	-0.00494101887655587	-0.00492322693397885	-0.00490190061353896	-0.00487715471997877	-0.00484910071916116	-0.00481784711845862	-0.00478349986266184	-0.00474616274019250	-0.00470593779442519	-0.00466292573495978	-0.00461722634373672	-0.00456893887094977	-0.00451815097439931	-0.00446492105163753	-0.00440932830985655	-0.00435144989601063	-0.00429135903612200	-0.00422912512284832	-0.00416481383997310	-0.00409848731916577	-0.00403020432432550	-0.00396002045882512	-0.00388798839100803	-0.00381415809336055	-0.00373857709088070	-0.00366129071429397	-0.00358234235392154	-0.00350177371018973	-0.00341962503697278	-0.00333593537419298	-0.00325074276634911	-0.00316408446391541	-0.00307599710484137	-0.00298651687368631	-0.00289567963624421	-0.00280352104784770	-0.00271007663388684	-0.00261536941746205	-0.00251939965168974	-0.00242221298939373	-0.00232385756977165	-0.00222438051040698	-0.00212382812164782	-0.00202224611793072	-0.00191967982442424	-0.00181617437766537	-0.00171177491914920	-0.00160652678110754	-0.00150047566397400	-0.00139366780527829	-0.00128615013994505	-0.00117797045218006	-0.00106917751932191	-0.000959821248208410	-0.000849952804757575	-0.000739624737592190	-0.000628891096643783	-0.000517807547755685	-0.000406431484365671	-0.000294822137386980	-0.000183040684421986	-7.11503594360693e-05	4.07834360092061e-05	0.000152693018912978	0.000264508307400599	0.000376156698802755	0.000487562942456996	0.000598649006560223	0.000709333938532071	0.000819533718494234	0.000929161105623641	0.00103812547729826	0.00114633266112039	0.00125368476007058	0.00136007997121471	0.00146541239855416	0.00156956795310096	0.00167244499363221	0.00177395277583055	0.00187399671623118	0.00197247908912178	0.00206929974096127	0.00216435678762846	0.00225754728974420	0.00234876790168777	0.00243791549033426	0.00252488771997125	0.00260958360030984	0.00269190399497920	0.00277175208839040	0.00284903380936068	0.00292365821040815	0.00299553780215031	0.00306458884276538	0.00313073158299837	0.00319389046771022	0.00325399429547337	0.00331097633820720	0.00336477442331672	0.00341533098124556	0.00346259306177378	0.00350651232278052	0.00354704499554785	0.00358415183100065	0.00361779803155876	0.00364794597006251	0.00367456748853452	0.00369767337029959	0.00371727954732894	0.00373340561664443	0.00374607483558356	0.00375531412946963	0.00376115411123237	0.00376362911231837	0.00376277722403089	0.00375864034824667	0.00375126425627353	0.00374069865443722	0.00372699725481994	0.00371021784941580	0.00369042238582145	0.00366767704244214	0.00364205230106541	0.00361362301453678	0.00358246846716334	0.00354867242537304	0.00351232317606997	0.00347351355004824	0.00343234092776150	0.00338890722468958	0.00334331885350220	0.00329568666018915	0.00324612583131152	0.00319475576952744	0.00314168879934606	0.00308697440479526	0.00303069754842900	0.00297295128545818	0.00291382739683300	0.00285341618331715	0.00279180628243167	0.00272908450635058	0.00266533569882601	0.00260064260923995	0.00253508578192273	0.00246874345894168	0.00240169149464956	0.00233400328038519	0.00226574967784209	0.00219699895975855	0.00212781675673617	0.00205826600915917	0.00198840692336399	0.00191829693139409	0.00184799065386709	0.00177753986567864	0.00170699346446633	0.00163639744195655	0.00156579485851444	0.00149522838456820	0.00142474369298297	0.00135438173788154	0.00128418181652127	0.00121418177287134	0.00114441805739111	0.00107492578783125	0.00100573881119148	0.000936889767042384	0.000868410152482060	0.000800330389052964	0.000732679891982099	0.000665487142139386	0.000598779761122801	0.000532584589884185	0.000466927771298195	0.000401834837056831	0.000337330799236352	0.000273440246838129	0.000210187447546921	0.000147596454884385	8.56912208570043e-05	2.44957141145316e-05	-3.59659564566186e-05	-9.56694128774194e-05	-0.000154589874229482	-0.000212702018191679	-0.000269979838436191	-0.000326396498460044	-0.000381924182525609	-0.000436532565837379	-0.000490190485954375	-0.000542881332952310	-0.000594588379106675	-0.000645293218692069	-0.000694976030108119	-0.000743615838124830];
% 
% w1 = w(1, :);
% w2 = w(2, :);
% w3 = w(3, :);
% x = 0:1:299;


t = 0:0.0001:1;
S = 0.7*sin(2*pi*t);
[Sf, ak_list, bk_list] = fourier(S, t, 999);%fft(S)

%fw1 = fourier_series( w1, x, 50);%fft(w1);

figure(1)
plot(t, S)
hold on
plot(t, Sf)

%% Fourier Series:

function [Snx, ak_list, bk_list] = fourier(fx, x, n)

    L = x(end) - x(1);
    a0 = trapz(x, fx);
    a0 = 2*a0/L;

    ak_list = [a0];
    bk_list = [];

    for k=1:1:n
        
        ak = trapz(x, fx.*cos(2*pi*k*x/L));
        ak = 2*ak/L;
        ak_list = [ak_list, ak];

        bk = trapz(x, fx.*sin(2*pi*k*x/L));
        bk = 2*bk/L;
        bk_list = [bk_list, bk];

    end

    Snx = a0/2;

    for k=1:1:n

        Snx = Snx + ak_list(k+1)*cos(2*pi*k*x/L) + bk_list(k)*sin(2*pi*k*x/L);

    end

end

